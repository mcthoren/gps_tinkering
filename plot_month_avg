#!/bin/sh

HOME="/import/home/ghz"
GPSP="$HOME/projects/gps"
GPS_MA="$GPSP/data/gps_alt_monthly_averages"

GPS_ALT_TEMP_0="$(mktemp /tmp/gps_alt.XXXXXXXXXXXXX)"
GPS_ALT_TEMP_1="$(mktemp /tmp/gps_alt.XXXXXXXXXXXXX)"
GPS_ALT_TEMP_HIST="$(mktemp /tmp/gps_alt.XXXXXXXXXXXXX)"

cat $GPSP/data/*/gps_alt.day.avg.* > "$GPS_ALT_TEMP_0"
gnuplot -e "ALTF='$GPS_ALT_TEMP_0';ALTF_MA='$GPS_MA'" "$GPSP/gps.gnuplot"
rm "${GPS_ALT_TEMP_0}"

cat $GPSP/data/*/gps_alt.dat.* > "$GPS_ALT_TEMP_1"
gnuplot -e "BOXF='$GPS_ALT_TEMP_1'" "$GPSP/boxplot.gnuplot"

$GPSP/alt_hist_gen "$GPS_ALT_TEMP_1" > "$GPS_ALT_TEMP_HIST"
gnuplot -e "ALT_HIST='$GPS_ALT_TEMP_HIST'" "$GPSP/alt_hist.gnuplot"

rm "${GPS_ALT_TEMP_1}"
rm "${GPS_ALT_TEMP_HIST}"
